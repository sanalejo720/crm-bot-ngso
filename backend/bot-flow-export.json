{
  "flow": {
    "name": "Flujo Cobranza con Validaci√≥n",
    "description": "Flujo completo: tratamiento de datos, validaci√≥n de documento y presentaci√≥n de deuda",
    "status": "active"
  },
  "nodes": [
    {
      "name": "Rechazo de Tratamiento",
      "type": "message",
      "config": {
        "action": "transfer_to_agent",
        "message": "Entendemos tu decisi√≥n. Sin embargo, sin tu autorizaci√≥n no podemos continuar.\n\nSi cambias de opini√≥n o deseas hablar con un asesor, puedes escribirnos nuevamente.\n\n¬°Que tengas un buen d√≠a! üëã"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Solicitar Documento",
      "type": "message",
      "config": {
        "message": "Perfecto, gracias por aceptar. ‚úÖ\n\nPara verificar tu identidad y mostrarte la informaci√≥n de tu cuenta, necesito que me proporciones tu n√∫mero de documento de identidad (C√©dula).\n\nPor favor, escribe solo los n√∫meros, sin puntos ni espacios.\n\nEjemplo: 1061749683",
        "saveResponse": true,
        "responseVariable": "documento"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Capturar Documento",
      "type": "input",
      "config": {
        "nextNodeId": null,
        "validation": {
          "type": "number",
          "maxLength": 12,
          "minLength": 6
        },
        "variableName": "documento_validado"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Documento Inv√°lido",
      "type": "message",
      "config": {
        "action": "wait_response",
        "message": "Lo siento, no encontr√© un registro con ese n√∫mero de documento asociado a este n√∫mero de tel√©fono. üîç\n\nPor favor, verifica que el n√∫mero de documento sea correcto o escribe \"ASESOR\" para ser transferido a un agente que pueda ayudarte. üë§",
        "timeout": 300
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Validar Aceptaci√≥n",
      "type": "condition",
      "config": {
        "variable": "user_response",
        "conditions": [
          {
            "value": "1",
            "operator": "equals",
            "nextNodeId": "fc63d498-4b1e-4869-bace-10aa51cc6ec3"
          },
          {
            "value": "acepto",
            "operator": "contains_ignore_case",
            "nextNodeId": "fc63d498-4b1e-4869-bace-10aa51cc6ec3"
          },
          {
            "value": "si",
            "operator": "contains_ignore_case",
            "nextNodeId": "fc63d498-4b1e-4869-bace-10aa51cc6ec3"
          }
        ],
        "elseNodeId": "eedd423e-a8ae-4ed8-882d-57f45805e6d1"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Saludo y Tratamiento de Datos",
      "type": "message",
      "config": {
        "message": "¬°Hola! üëã Somos del departamento de cobranzas de NGS&O Abogados.\n\nTe contactamos porque tienes una cuenta pendiente con nosotros.\n\nPara poder ayudarte, necesitamos que aceptes el tratamiento de tus datos personales seg√∫n nuestra pol√≠tica de privacidad.\n\nPor favor responde:\n1Ô∏è‚É£ Acepto\n2Ô∏è‚É£ No acepto",
        "variables": [
          {
            "name": "company",
            "type": "string",
            "field": "metadata.compania",
            "source": "debtor",
            "default": "nuestra empresa"
          }
        ]
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Presentaci√≥n de Deuda",
      "type": "message",
      "config": {
        "message": "¬°Perfecto! Encontr√© tu informaci√≥n. üìã\n\n*DATOS DE TU CUENTA:*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüë§ Nombre: {{debtor.fullName}}\nüÜî Documento: {{debtor.documentType}} {{debtor.documentNumber}}\nüè¢ Producto: {{debtor.metadata.producto}}\nüí∞ Deuda Total: ${{debtor.debtAmount}}\n‚è∞ D√≠as de Mora: {{debtor.daysOverdue}} d√≠as\nüìÖ Fecha de Vencimiento: {{debtor.metadata.fechaVencimiento}}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nPara resolver esta situaci√≥n, puedes:\n\n1Ô∏è‚É£ Pagar ahora\n2Ô∏è‚É£ Acordar fecha de pago\n3Ô∏è‚É£ Hablar con un asesor\n\nPor favor, responde con el n√∫mero de tu opci√≥n.",
        "variables": [
          {
            "name": "debtor.fullName",
            "type": "string",
            "field": "fullName",
            "source": "debtor"
          },
          {
            "name": "debtor.documentType",
            "type": "string",
            "field": "documentType",
            "source": "debtor"
          },
          {
            "name": "debtor.documentNumber",
            "type": "string",
            "field": "documentNumber",
            "source": "debtor"
          },
          {
            "name": "debtor.metadata.producto",
            "type": "string",
            "field": "metadata.producto",
            "source": "debtor"
          },
          {
            "name": "debtor.debtAmount",
            "type": "number",
            "field": "debtAmount",
            "source": "debtor"
          },
          {
            "name": "debtor.daysOverdue",
            "type": "number",
            "field": "daysOverdue",
            "source": "debtor"
          },
          {
            "name": "debtor.metadata.fechaVencimiento",
            "type": "string",
            "field": "metadata.fechaVencimiento",
            "source": "debtor"
          }
        ],
        "saveResponse": true,
        "responseVariable": "opcion_pago"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Evaluar Opci√≥n",
      "type": "condition",
      "config": {
        "variable": "opcion_pago",
        "conditions": [
          {
            "value": "1",
            "operator": "equals",
            "nextNodeId": "cbd3c868-f1d7-4bd9-bffb-3acb8fc19ba5"
          },
          {
            "value": "2",
            "operator": "equals",
            "nextNodeId": "cbd3c868-f1d7-4bd9-bffb-3acb8fc19ba5"
          },
          {
            "value": "3",
            "operator": "equals",
            "nextNodeId": "cbd3c868-f1d7-4bd9-bffb-3acb8fc19ba5"
          }
        ],
        "elseNodeId": "cbd3c868-f1d7-4bd9-bffb-3acb8fc19ba5"
      },
      "positionX": 0,
      "positionY": 0
    },
    {
      "name": "Transferir a Asesor",
      "type": "transfer_agent",
      "config": {
        "reason": "requested_by_customer",
        "message": "Perfecto, en un momento uno de nuestros asesores ser√° asignado a tu caso para ayudarte con tu solicitud. ‚è≥\n\nPor favor espera un momento mientras te conectamos con un especialista.",
        "priority": "high"
      },
      "positionX": 0,
      "positionY": 0
    }
  ]
}