Quiero que act√∫es como arquitecto de software senior y desarrollador full-stack experto en CRMs para call centers, con experiencia comprobada en:

- Integraciones con WhatsApp Business API (Meta Cloud API).
- Integraciones con WPPConnect (Node.js).
- Dise√±o de CRM omnicanal, enrutamiento de chats y dashboards de supervisi√≥n.
- Arquitecturas escalables para 18‚Äì30 agentes concurrentes y m√∫ltiples n√∫meros de WhatsApp.

üéØ OBJETIVO GENERAL
Necesito que dise√±es y me ayudes a construir paso a paso un **CRM para call center enfocado en WhatsApp Bot**, donde se puedan usar:
- De **1 a 10 n√∫meros de WhatsApp** (cada n√∫mero puede ser de Meta o WPPConnect).
- Entre **18 y 30 agentes humanos** conectados simult√°neamente.
- Roles: **Super Administrador, Supervisor, Agente, Calidad, Auditor√≠a**.

El CRM debe permitir:
- Atenci√≥n por bot (WhatsApp) + transferencia a agente humano.
- Enrutamiento de chats por colas / campa√±as / habilidades.
- Gesti√≥n completa de clientes, chats, tickets, tareas y seguimiento.
- M√≥dulo de estad√≠sticas y reportes para gesti√≥n tipo call center.
- Copias de seguridad, auditor√≠as y trazabilidad de la gesti√≥n.

üìå STACK TECNOL√ìGICO
1. Primero, **preg√∫ntame** con qu√© stack quiero trabajar (ejemplos):
   - Opci√≥n A: Backend en **Node.js + TypeScript** (Express o NestJS) + Base de datos relacional (PostgreSQL o MySQL) + Frontend en **React**.
   - Opci√≥n B: Backend en **Laravel (PHP)** + Base de datos MySQL/PostgreSQL + Panel admin (por ejemplo, Filament / Laravel Nova / Inertia + Vue/React).
   - Opci√≥n C: Otra combinaci√≥n que t√∫ recomiendes para alta concurrencia y facilidad de mantenimiento.

2. Una vez definido el stack, quiero que:
   - Propongas una **arquitectura por m√≥dulos** (auth, usuarios, roles, campa√±as, bots, chats, etc.).
   - Dise√±es el **modelo de datos** completo (tablas/colecciones y relaciones).
   - Plantees una estructura de carpetas limpia y escalable.

üë• ROLES Y PERMISOS
Definir claramente los roles y sus capacidades:

1. **Super Administrador**
   - Gestionar toda la plataforma.
   - Crear/editar/eliminar empresas (si planteas multiempresa), campa√±as, colas, agentes, supervisores.
   - Configurar integraciones con Meta API y WPPConnect (tokens, webhooks, instancias).
   - Ver TODAS las estad√≠sticas globales.
   - Configurar copias de seguridad (backups) manuales y programadas.

2. **Supervisor**
   - Ver y gestionar los chats de su campa√±a/equipo.
   - Asignar, transferir o reasignar chats entre agentes.
   - Monitoreo en tiempo real: chats activos, agentes conectados, estado de cada agente.
   - Ver m√©tricas por campa√±a/equipo/agente (SPH, cantidad de chats, TMO, etc.).
   - Cerrar chats o intervenir cuando sea necesario (modo ‚Äútomar control‚Äù).

3. **Agente**
   - Recibir chats asignados autom√°ticamente o manualmente.
   - Responder mensajes v√≠a interfaz web de CRM.
   - Usar respuestas r√°pidas / plantillas / snippets.
   - Ver el historial del cliente, tags, notas internas.
   - Cambiar su estado: disponible, en pausa, en llamada, desconectado.

4. **Calidad**
   - Acceso a grabaciones de conversaciones (solo texto de los chats).
   - Marcar interacciones con calificaci√≥n de calidad.
   - Dejar observaciones y tags de calidad por chat (ej: ‚Äúmala actitud‚Äù, ‚Äúno sigui√≥ script‚Äù).
   - Descargar reportes de calidad por agente / campa√±a / rango de fechas.

5. **Auditor√≠a**
   - Acceso de solo lectura a logs de sistema y registros de cambios.
   - Ver qui√©n asign√≥ qu√© chat, cu√°ndo se traslad√≥, qui√©n cerr√≥ el caso, etc.
   - Generar reportes de auditor√≠a con filtros avanzados.

üì≤ N√öMEROS DE WHATSAPP (1 a 10)
Dise√±ar un m√≥dulo para:

- Registrar y gestionar **m√∫ltiples n√∫meros de WhatsApp**:
  - Tipo de integraci√≥n: Meta Cloud API / WPPConnect.
  - Token / credenciales / URL de webhook / instancia.
  - Estado del n√∫mero: activo, pausado, en error.
- Asociar n√∫meros a:
  - Campa√±as espec√≠ficas.
  - Colas de atenci√≥n.
  - Horarios de funcionamiento.
- Reglas de enrutamiento:
  - Por n√∫mero de origen (ej. n√∫mero 1 = Campa√±a A, n√∫mero 2 = Campa√±a B).
  - Por palabra clave detectada en el bot.
  - Por carga de agentes (balanceo b√°sico).

ü§ñ BOT DE WHATSAPP + AGENTE HUMANO
Quiero que el sistema tenga dos capas:

1. **Capa Bot**
   - Flujos conversacionales definidos en base de datos (√°rboles de decisi√≥n).
   - Soportar:
     - Men√∫s tipo texto / botones (seg√∫n API).
     - Variables (ej.: nombre, documento, email).
     - Enlaces a landing pages o formularios externos si es necesario.
   - Capacidad para:
     - Registrar leads/contactos.
     - Validar datos b√°sicos.
     - Encolar al cliente para agente humano.

2. **Transferencia a Agente Humano**
   - El bot entrega la conversaci√≥n con:
     - Contexto del chat.
     - Datos capturados (nombre, tel√©fono, campa√±a, tags).
   - El CRM asigna autom√°ticamente al mejor agente disponible seg√∫n:
     - Cola/campa√±a.
     - Skill (etiquetas de agente).
     - Reglas de distribuci√≥n (round robin, carga, prioridad).
   - Posibilidad de que el agente devuelva la conversaci√≥n a la cola o la transfiera a otro agente/supervisor.

üìá M√ìDULO CRM / GESTI√ìN DE CLIENTES
Definir y modelar:

- Entidad **Cliente/Contacto**:
  - Datos b√°sicos: nombre, tel√©fono (clave principal l√≥gica), email, ciudad, etc.
  - Tags: ‚Äúcliente nuevo‚Äù, ‚Äúrecurrente‚Äù, ‚ÄúVIP‚Äù, ‚Äúmora‚Äù, etc.
  - Estado del lead: nuevo, en gesti√≥n, cerrado ganado, cerrado perdido, seguimiento.
  - Historial de conversaciones por n√∫mero y canal.

- Entidad **Chat / Conversaci√≥n**:
  - Asociaci√≥n a cliente, n√∫mero de WhatsApp, campa√±a, agente.
  - Timestamps: primer contacto, primera respuesta, cierre.
  - Motivo de contacto, resultado, tags.
  - Notas internas y tareas asociadas.

- Entidad **Tareas / Recordatorios**:
  - Para hacer seguimiento a un chat o cliente en fecha/hora espec√≠fica.
  - Notificaciones internas para el agente y, opcionalmente, el supervisor.

üìä ESTAD√çSTICAS Y REPORTES
Dise√±ar un m√≥dulo de estad√≠sticas tipo call center donde se pueda ver:

- Por rango de fechas, campa√±a, n√∫mero de WhatsApp, agente:
  - Total de chats recibidos.
  - Chats atendidos.
  - Chats abandonados (sin respuesta).
  - Tiempo medio de respuesta (TMR / FRT).
  - Tiempo medio de atenci√≥n (TMO).
  - Conversaciones cerradas y su resultado.
  - SPH / conversiones (si se usa metric de ventas).
- Tableros en tiempo real:
  - Agentes conectados y su estado.
  - Chats activos.
  - Cola de espera.
  - SLA de respuesta (porcentaje en X segundos/minutos).

üíæ COPIAS DE SEGURIDAD Y AUDITOR√çA
Incluir en el dise√±o:

- Mecanismo de **backup**:
  - Exportar base de datos o colecciones clave.
  - Programar backups autom√°ticos (ej.: diario) y descarga manual.
- M√≥dulo de **logs/auditor√≠a**:
  - Registro de login/logout.
  - Cambios de configuraci√≥n (integraciones, campa√±as, roles).
  - Asignaciones y transferencias de chats.

üîê SEGURIDAD Y ACCESOS
Definir:

- Sistema de autenticaci√≥n con JWT / sesiones seguras.
- Control de acceso basado en roles (RBAC).
- Opciones de 2FA (si lo recomiendas).
- Validaciones para evitar acceso a chats o datos fuera del √°mbito del rol.

üì¶ ENTREGABLES QUE NECESITO DE TI (PASO A PASO)
Quiero que trabajes de forma **iterativa**, entregando en orden:

1. **Resumen de la arquitectura propuesta** (diagrama conceptual y explicaci√≥n).
2. **Modelo de datos completo**, con todas las tablas/colecciones y relaciones.
3. **Dise√±o de endpoints / APIs** principales:
   - Autenticaci√≥n y gesti√≥n de usuarios/roles.
   - Gesti√≥n de n√∫meros de WhatsApp.
   - Recepci√≥n de webhooks de WhatsApp (Meta / WPPConnect).
   - Env√≠o de mensajes.
   - Gesti√≥n de chats, asignaciones y transferencias.
   - M√≥dulo de estad√≠sticas y reportes.
4. **Estructura de carpetas del proyecto** siguiendo buenas pr√°cticas del stack elegido.
5. **Ejemplos de c√≥digo reales**, incluyendo:
   - Configuraci√≥n de la integraci√≥n con Meta WhatsApp Cloud API.
   - Configuraci√≥n de la integraci√≥n con WPPConnect.
   - Ejemplo de webhook de recepci√≥n de mensajes.
   - Ejemplo de asignaci√≥n autom√°tica de chats a agentes.
6. **Dise√±o del frontend**:
   - Vistas para cada rol (Super Admin, Supervisor, Agente, Calidad, Auditor√≠a).
   - Mockups con descripci√≥n funcional de cada pantalla.
7. **Gu√≠a de despliegue**:
   - Requerimientos de servidor.
   - Variables de entorno.
   - Comandos de build / migrations / seeds.
   - Recomendaciones para producci√≥n (escalabilidad, colas de trabajo, monitoreo).

üß† ESTILO DE RESPUESTA QUE QUIERO
- Explica todo de forma **muy clara y estructurada**.
- Usa t√≠tulos, subt√≠tulos, listas y ejemplos de c√≥digo bien formateados.
- Siempre que propongas algo t√©cnico (endpoint, tabla, flujo), expl√≠calo con:
  - **El qu√©**, **el por qu√©** y **el c√≥mo** implementarlo.
- Si ves mejoras o buenas pr√°cticas adicionales (como colas de mensajes, rate limiting, workers, etc.), proponlas proactivamente.

Empecemos por el paso 1: proponme 2‚Äì3 arquitecturas posibles (con stack tecnol√≥gico concreto) y dime cu√°l recomiendas para este CRM de WhatsApp bot con 18‚Äì30 agentes y 1‚Äì10 n√∫meros de WhatsApp, justificando tu recomendaci√≥n.
